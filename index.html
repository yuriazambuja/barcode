<!DOCTYPE html>
<html lang='pt-BR'>
	<head>
		<title>BarCode</title>
		<meta charset='UTF-8' />
		<meta name="robots" content="noindex" />
		<meta name="viewport" content="width=device-width,user-scalable=no" />
		<script type="text/javascript" src="cordova.js"></script>
		<script type="text/javascript" src="webservice.js"></script>
		<script type="text/javascript" src="jquery.js"></script>
		<style>
		* {
			box-sizing:border-box;
			font-family: verdana;
			user-select: none;
		}
		html, body {
			height:100%;
			margin:0;
			font-size:10px;
			padding:0 10px;
		}
		input, button {
			width:100%;
			padding:10px;
			margin:10px 0;
		}
		label {
			font-weight:bold;
		}
		</style>
		<script>
		function barcode(){
			$('#codigo').val('');
			cordova.plugins.barcodeScanner.scan(
				function (result) {
					if(!result.cancelled){
						$('#codigo').val(result.text);
					}
				},
				function (error) {
					alert("Scanning failed: " + error);
				},
				{
					//preferFrontCamera : true, // iOS and Android
					//showFlipCameraButton : true, // iOS and Android
					//saveHistory: true, // Android, save scan history (default false)
					//formats : "QR_CODE,PDF_417", // default: all but PDF_417 and RSS_EXPANDED
					//orientation : "landscape", // Android only (portrait|landscape), default unset so it rotates with the device
					showTorchButton : true, // iOS and Android
					torchOn: true, // Android, launch with the torch switched on (if available)
					prompt : "POSICIONE O CÓDIGO DE BARRAS NA ÁREA INDICADA", // Android
					resultDisplayDuration: 500, // Android, display scanned text for X ms. 0 suppresses it entirely, default 1500
					disableAnimations : true, // iOS
					disableSuccessBeep: false // iOS and Android
				}
			);
		}
		function correios(){
			$('#logradouro').val('');
			$('#bairro').val('');
			$('#cidade').val('');
			$('#estado').val('');
			var wsdl = "https://apps.correios.com.br/SigepMasterJPA/AtendeClienteService/AtendeCliente?wsdl";
			new WebService(wsdl).call("consultaCEP",{cep:$('#codigo').val()},function(status,object){
				if(status==200){
					$('#logradouro').val(object.return.end);
					$('#bairro').val(object.return.bairro);
					$('#cidade').val(object.return.cidade);
					$('#estado').val(object.return.uf);
				}else{
					alert("WebService failed: " + status);
				}
			});
		}
		$(document).ready(function(){
			$('#barcode').click(barcode);
			$('#correios').click(correios);
		});
		</script>
	</head>
	<body>
		<label>CEP</label>
		<input type='text' id='codigo'/>
		<button id='barcode'>CÓDIGO DE BARRAS</button>
		<label>LOGRADOURO</label>
		<input type='text' id='logradouro' disabled/>
		<label>BAIRRO</label>
		<input type='text' id='bairro' disabled/>
		<label>CIDADE</label>
		<input type='text' id='cidade' disabled/>
		<label>ESTADO</label>
		<input type='text' id='estado' disabled/>
		<button id='correios'>CONSULTA CORREIOS</button>
	</body>
</html>
